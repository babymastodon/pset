{% extends 'main/base.html' %}
{% load url from future %}{% load staticfiles %}

{% block main_content %}
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script src="{% static 'js/geolocation.js'%}" type="text/javascript"></script>
<script type="text/javascript">
    class_pk = {{class.pk}};
    party_list = {{party_list|safe}};
</script>
<script src="{% static 'js/class_details.js'%}" type="text/javascript"></script>

<div class="grid_12 details_panel">
    <div class="page_header nounderline clearfix">
        <img src="{% static 'images/css/icons/cup32.png'%}"/>
        <span class="header_text" style="max-width: 600px;">Welcome {{user.get_name}}</span>
        <a href="{% url 'main.account_views.manage_classes' %}" class="gray_button fright">Manage Classes</a>
        <a href="{% url 'main.search_views.parties_by_date' %}" class="gray_button fright" style="margin-right: 10px">All Parties</a>
        <a href="{% url 'main.party_views.party_create' %}" class="gray_button fright" style="margin-right: 10px">New Party</a>
    </div>
</div>
<div class="clear"></div>
<div class="grid_3 center">
    <a href="{{user.get_link}}">
    <img src="{{user.get_image}}" class="profile_image" />
</a>
</div>
<div class="grid_6">
    <div class="page_header clearfix">
        <img src="{% static 'images/css/icons/mapleleaf32.png'%}"/>
        <span class="header_text">My Classes</span>
    </div>
    <ul class="page_list">
        {% for k in myclasses %}
        <li class="clearfix">
        <a class="user_select clearfix" href="{{k.ob.get_link}}">
            <img src="{{k.ob.get_image}}" class="user_thm" />
            <span class="list_text" style="width: 310px;">{{k.ob.get_name}}</span>
            <span class="list_text">{{k.n}} {% if k.n = 1 %}party{% else %}parties{% endif %}</span>
        </a>
        </li>
        {% empty %}
        <li class="clearfix">
        <img src="{% static 'images/css/icons/unsmile32.png' %}" class="news_icon" />
        <span class="list_text">You haven't added any classes yet.<br/>Click <b><a href="{% url 'main.account_views.manage_classes' %}" >here</a></b> to get started</span>
        </li>
        {% endfor %}
    </ul>
</div>
<div class="grid_3">
    <div id="mapdiv" style="width: 220px; height: 120px;"></div>
    <div class="space_20"></div>
    <div class="center">
        <span class="hcenter plain_text"><b style="font-size: 20px;">{{numparties}}</b> {% if numparties = 1 %}party{%else%}parties{%endif%}</span>
        recommended for you
    </div>
    <div class="space_20"></div>
    <a href="{{class.map_view}}" class="gray_button hcenter">Switch to Map View</a>
</div>
<div class="clear"></div>
<div class="space_20"></div>
<div class="grid_4">
    <div>
        {% with history=calendar %}
        {% include 'main/party/history_list.html' %}
        {% endwith %}
    </div>
    <div class="space_40"></div>
</div>
<div class="grid_8">
    <div>
        {% with feed=newsfeed %}
        {% include 'main/modules/feed_list.html' %}
        {% endwith %}
    </div>
    <div class="clear"></div>
    <div class="space_40"></div>
</div>

{% endblock %}
